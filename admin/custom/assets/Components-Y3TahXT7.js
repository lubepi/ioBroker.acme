import{j as e}from"./jsx-runtime-DdSuII4L.js";import{C as t}from"./ConfigCustomAcmeSet__loadShare___mf_0_mui_mf_1_material__loadShare__-CPZ-AMWP.js";import{C as i}from"./ConfigCustomAcmeSet__loadShare___mf_0_iobroker_mf_1_adapter_mf_2_react_mf_2_v5__loadShare__-ClGrj2ss.js";import{C as c}from"./ConfigCustomAcmeSet__mf_v__runtimeInit__mf_v__-ZTRlPSE_.js";import"./ConfigCustomAcmeSet__loadShare__react__loadShare__-CfKh66-6.js";import"./_commonjsHelpers-CE1G-McA.js";const{initPromise:_}=c,m=_.then(l=>l.loadShare("@iobroker/json-config",{customShareInfo:{shareConfig:{singleton:!0,strictVersion:!1,requiredVersion:"*"}}})),h=await m.then(l=>l());var d=h;const a={ok:{color:"#0ba20b"},warn:{color:"#f57d1d"},error:{color:"#c42c3a"}};class f extends d.ConfigGeneric{constructor(o){super(o),this.state={...this.state,collections:null}}async componentDidMount(){super.componentDidMount(),await this.readData(),await this.props.oContext.socket.subscribeObject("system.certificates",this.onCertsChanged)}async readData(o){var r;const s=o||await this.props.oContext.socket.getObject("system.certificates");let n;(r=s==null?void 0:s.native)!=null&&r.collections?n=s.native.collections:n={},this.setState({collections:n})}async componentWillUnmount(){await this.props.oContext.socket.unsubscribeObject("system.certificates",this.onCertsChanged)}onCertsChanged=(o,s)=>{o==="system.certificates"&&s&&this.readData(s).catch(()=>{})};renderItem(){return this.state.collections?e.jsxs("div",{style:{width:"100%"},children:[e.jsx("h4",{children:i.I18n.t("custom_acme_title")}),e.jsx(t.TableContainer,{component:t.Paper,style:{width:"100%"},children:e.jsxs(t.Table,{style:{width:"100%"},size:"small",children:[e.jsx(t.TableHead,{children:e.jsxs(t.TableRow,{children:[e.jsx(t.TableCell,{children:i.I18n.t("custom_acme_id")}),e.jsx(t.TableCell,{children:i.I18n.t("custom_acme_status")}),e.jsx(t.TableCell,{children:i.I18n.t("custom_acme_domains")}),e.jsx(t.TableCell,{children:i.I18n.t("custom_acme_staging")}),e.jsx(t.TableCell,{children:i.I18n.t("custom_acme_expires")}),e.jsx(t.TableCell,{})]})}),e.jsx(t.TableBody,{children:this.state.collections&&Object.keys(this.state.collections).map(o=>{if(!this.state.collections)return null;const s=this.state.collections[o];let n;return new Date(s.tsExpires).getTime()>Date.now()&&!s.staging?n=e.jsx("span",{style:a.ok,children:"OK"}):new Date(s.tsExpires).getTime()<=Date.now()?n=e.jsx("span",{style:a.error,children:i.I18n.t("custom_acme_expired")}):s.staging&&(n=e.jsx("span",{style:a.warn,children:i.I18n.t("custom_acme_staging")})),e.jsxs(t.TableRow,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(t.TableCell,{component:"th",scope:"row",children:o}),e.jsx(t.TableCell,{children:n}),e.jsx(t.TableCell,{children:s.domains.join(", ")}),e.jsx(t.TableCell,{style:s.staging?a.warn:void 0,children:s.staging?"âœ“":""}),e.jsx(t.TableCell,{style:new Date(s.tsExpires).getTime()<Date.now()?a.error:void 0,children:new Date(s.tsExpires).toLocaleString()})]},o)})})]})})]}):e.jsx(t.LinearProgress,{})}}const b={AcmeComponent:f};export{b as default};
